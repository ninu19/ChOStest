<html>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
<script src="responsivevoice.js"></script>
<script src="directives.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<body ng-app="myApp" ng-controller="myCtrl">


 <div read-text="{{firstName}}"  class="btn-group btn-group-spaced-sm btn-group-voice row-vspace-md">
             <button class='start' value='start' type='button'>START</button>
             <button class='stop' value='stop' type='button'>STOP</button>
             <button class='resume' value='resume' type='button'>RESUME</button>
             <button class='pause' value='pause' type='button'>PAUSE</button>

</div>
 
<script>
var app = angular.module('myApp', []);
app.controller('myCtrl', function($scope) {
    $scope.firstName = "John";
    
});
</script>
<script>
var app = angular.module("myApp", []);
app.directive('readText', function ($rootScope,$interval) {
        return {
            restrict: "A",
            link: function (scope, elem, attr) {
                $rootScope.isPause = false;
                var sBrowser, sUsrAg = navigator.userAgent;
                $(elem).find(".start").click(function () {
                    $rootScope.isPause = false;
                    var rateInput = document.getElementById('rate');
                        $(".pause").hide();
                        $(".resume").hide();
                        $(".start").show();
                        $(".stop").hide();
                    responsiveVoice.cancel();
                    $(this).hide();
                    $(elem).find(".pause").show();
                    $(elem).find(".stop").show();
                    responsiveVoice.speak(" ");
                    setTimeout(function() {
                    var symbols = [
                        {code:"<[^>]*>",replace:''},
                        {code:"[{()}]",replace:""},
                    ];
                    var text = attr["readText"];

                    symbols.forEach(function(el) {
                        text = text.replace(new RegExp(el.code, 'g'), el.replace);
                    });
                    text = $("<div></div>").html(text).text();
                    if (sUsrAg.indexOf("CrOS") > -1) {
                        responsiveVoice.speak(text, "Chrome OS US English", {
                            rate: rateInput.value,
                            onend: function () {
                                $(".pause").hide();
                                $(".resume").hide();
                                $(".start").show();
                                $(".stop").hide();
                            }
                        });
                    } else {
                        responsiveVoice.speak(text, "US English Female", {
                            rate: rateInput.value,
                            onend: function () {
                                $(".pause").hide();
                                $(".resume").hide();
                                $(".start").show();
                                $(".stop").hide();
                            }
                        });
                    }
                    }, 130);
                    });

                $(elem).find(".stop").click(function () {
                    $rootScope.isPause = false;
                    responsiveVoice.cancel();
                    $(this).hide();
                    $(elem).find(".pause").hide();
                    $(elem).find(".resume").hide();
                    $(elem).find(".start").show();
                    $(elem).find(".rate").hide();
                }).hide();
                $(elem).find(".pause").click(function () {
                    $rootScope.isPause = true;
                    responsiveVoice.pause();
                        $(elem).find(".pause").hide();
                        $(this).hide();
                        $(elem).find(".resume").show();
                        
                            var interval = $interval(function(){
                                if($rootScope.isPause == true){
                                responsiveVoice.pause();
                                clearInterval(interval)
                                }
                            }, 5000);                      
                }).hide();
                
                $(elem).find(".resume").click(function () {
                    $rootScope.isPause = false;
                    $(this).hide();
                    $(elem).find(".pause").show();
                    responsiveVoice.resume();
                }).hide();

                
            },
        };
    })
 </script>
  </body>
</html>
